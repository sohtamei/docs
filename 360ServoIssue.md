## 360度サーボFS90R問題について

M5CameraCarでは360度サーボFS90Rを使っています。  
FS90Rは仕様上の問題があり、M5CameraCarでの対処方法と限界についてメモさせて頂きます。

#### 問題１．回転数0%から50%までのPWMの調節範囲が約0.06ms (±12step/4096) しかない。

PWM周期=20ms、分解能4096とした場合下記の通り。調整範囲全体のうち実際に回転数調整に使える調整範囲はごく一部。  

[FS90R仕様書](https://akizukidenshi.com/download/ds/feetech/fs90r.pdf)


| 周期 | PWM設定値 | PWMオフセット | モーター回転 |
| ---- | ---- | ---- | ---- |
| 0.7ms | 143 | -163 | 逆回転100% |
| 1.41ms | 289 | -18 | 逆回転50% |
| 1.47ms | 301 | -6 | 逆回転0% |
| 1.5ms | 307 | ±0 | 停止 |
| 1.53ms | 313 | <font color="#ff0000">+6</font> | 正回転0% |
| 1.59ms | 325 | <font color="#ff0000">+18</font> | 正回転50% |
| 2.3ms | 471 | +163 | 正回転100% |

![image](https://user-images.githubusercontent.com/43091864/96739940-4e852600-13fb-11eb-8d22-d41757b14a31.png)

#### 問題２．サーボの発熱でPWMの設定値が+5setp程度ずれる

回転数Left=50%(+18step), Right=50%(-18step)のとき同じPWM設定値で発熱によりLeft=32%(+13step相当), Right=61%(-23step相当)までずれる。

#### 対処方法と限界

- M5CameraCarでは治具により回転数0%、50%、100%のPWM設定値を測定しています、この調整値をマイコンに書き込むことにより回転数50%、100%である程度直進できるようになっています。ただしサーボの発熱等により設定値-回転数のカーブがずれてしまうため正確にまっすぐには進みません。（回転数50%で冷えているとき左方向に反れます）

- 50%以下の回転数では直進するよう調整できないため+100%, +50%の2段階しか設定できません。左右の方向調整は細かく調整できます。
